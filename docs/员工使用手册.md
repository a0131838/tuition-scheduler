# Tuition Scheduler 员工使用手册（运营版）

更新日期：2026-02-09  
适用对象：教务运营、管理者、老师

---

## 1. 角色与权限

### 1.1 角色说明
- `ADMIN`：可进入管理端，执行教务运营操作。
- `MANAGER`（管理者名单中的账号）：可访问管理者驾驶舱与系统用户管理。
- `OWNER MANAGER`（zhao hongwei）：管理者中的最高权限。
- `TEACHER`：进入老师端，维护可上课时间、点名、课后反馈、名片。

### 1.2 当前关键权限规则
- 老师账号如果在管理者名单中，也可进入管理端。
- 系统使用者页面：
  - 普通管理者不能编辑 `zhao hongwei`。
  - 管理者中的管理员账号（manager-admin）受保护，不可编辑。
  - owner 可维护管理者名单。

---

## 2. 登录与语言

### 2.1 登录入口
- 地址：`/admin/login`
- 两个按钮：
  - `进入管理端 / Admin`
  - `进入老师端 / Teacher`

### 2.2 登录跳转规则
- 纯老师账号：进入老师端。
- 管理账号（含管理者名单中的老师账号）：可进入管理端。

### 2.3 语言切换
- 管理端右上角可切换：`Bilingual / 双语`、`中文`、`English`。
- 老师端文案按账号语言显示（双语/中文/英文）。

---

## 3. 员工日常工作流（建议）

### 3.1 每日开工（教务）
1. 打开 `待办中心`：`/admin/todos`
2. 处理 `昨日/今日未点名`。
3. 处理 `明日提醒（老师/学生）`。
4. 查看 `每日冲突巡检` 与 `自动修复日志`。
5. 查看 `续费预警`（课包余额/预计可用天数）。

### 3.2 排课与冲突处理
1. 在 `周课表` 或 `新建(单次)` 创建课程/预约。
2. 发现冲突后进入 `冲突处理中心`。
3. 执行换老师、换教室、取消课次/预约。

### 3.3 班课与报名
1. 先建班（课程、老师、校区教室、容量）。
2. 在报名页或班级详情页添加报名。
3. 按需导出报名 PDF。

### 3.4 学生经营
1. 在学生详情查看课包、出勤、历史安排。
2. 使用快速排课安排一对一。
3. 导出学生课表 PDF。

---

## 4. 管理端功能明细

## 4.1 概览与运营

### 4.1.1 Dashboard（总览）`/admin`
- 用途：快速跳转、基础搭建顺序提示。
- 建议顺序：校区 → 教室 → 老师 → 课程 → 班级 → 课次 → 学生选课链接。

### 4.1.2 Todo Center（待办中心）`/admin/todos`
- 核心功能：
  - 每日冲突巡检结果
  - 自动修复（老师冲突）日志
  - 昨日/今日未点名列表
  - 明天提醒（老师/学生）确认
  - 历史未点名分页
  - 续费预警
- 重点操作：
  - `去点名`
  - `立即复检`
  - `立即执行`（自动修复）
- 注意：优先清理未点名和冲突，再做新增排课。

### 4.1.3 Sign-in Alerts（签到告警）`/admin/alerts`
- 用途：查看未签到、反馈超时告警。
- 可配置：告警阈值（分钟）。
- 可直达课次点名页处理。

---

## 4.2 基础数据

### 4.2.1 校区 ` /admin/campuses`
- 新增/删除校区。
- 注意：删除校区会级联删除班级、课次、报名、教室（高风险）。

### 4.2.2 教室 `/admin/rooms`
- 新增教室（校区、容量）。
- 删除教室前确认无业务依赖。

### 4.2.3 学生来源 `/admin/student-sources`
- 新增来源、启用/停用。
- 若已被学生使用，不能删除，只能停用。

### 4.2.4 学生类型 `/admin/student-types`
- 新增类型、启用/停用。
- 若已被学生使用，不能删除，只能停用。

### 4.2.5 课程体系 `/admin/courses`
- 维护 `Course / Subject / Level`。
- 老师授课能力、班级创建、快速排课都依赖此数据。

---

## 4.3 人员

### 4.3.1 老师列表 `/admin/teachers`
- 新增老师、删除老师。
- 可进入老师详情做账号绑定、模板、批量生成课次。
- 可导出老师名片 PDF。

### 4.3.2 老师详情 `/admin/teachers/[id]`
- 编辑老师资料（介绍、教育背景、教学语言等）。
- 账号绑定：
  - 绑定已有系统用户
  - 创建并绑定账号
  - 解绑账号
- 一对一模板管理。
- 批量生成课次（可预览冲突并跳过冲突）。

### 4.3.3 老师可用时间（教务维护）`/admin/teachers/[id]/availability`
- 按日期维护可用时间。
- 每周模板批量生成整月可用时间。
- 时间范围限制：`08:00-23:00`（不支持 23:00-次日 08:00）。

### 4.3.4 老师名片页面 `/admin/teachers/[id]/card`
- 预览名片、导出 PDF。
- 当前已修复中文字体与右侧重叠问题。

### 4.3.5 学生列表 `/admin/students`
- 新增、筛选、删除学生。
- 删除学生会同时删除关联报名/预约/课包（谨慎）。

### 4.3.6 学生详情 `/admin/students/[id]`
- 功能：
  - 编辑学生信息
  - 课包查看与跳转
  - 出勤记录查看
  - 快速排课（按学生条件）
  - 导出学生课表 PDF（Download Schedule PDF）
- 快速排课规则：
  - 仅显示学生已购课程相关选项。
  - 若该课程无有效课包，禁止排课并提示。
  - 若无可安排老师/课程，不保留脏状态。
  - 排课成功后弹窗自动关闭。

---

## 4.4 排课与出勤

### 4.4.1 周课表 `/admin/schedule`
- 统一查看课次与预约。
- 可执行换老师、删除课次、删除预约、处理冲突。

### 4.4.2 全周总览 `/admin/schedule/all`
- 按天查看整周事件，便于运营统览。

### 4.4.3 新建单次 `/admin/schedule/new`
- 新建班课单次课次。
- 新建一对一预约。
- 会校验老师可用时间与冲突。

### 4.4.4 冲突处理中心 `/admin/conflicts`
- 冲突类型：
  - 老师冲突（课次/预约重叠）
  - 教室冲突（课次重叠）
- 操作：
  - 换老师
  - 换教室
  - 取消课次
  - 取消预约

### 4.4.5 课次点名 `/admin/sessions/[id]/attendance`
- 点名保存会自动扣减课包并记账（支持回滚）。
- 支持一键全到。
- 支持请假计费规则（EXCUSED）。

---

## 4.5 班级、报名、课包

### 4.5.1 班级列表 `/admin/classes`
- 新建班级、查看班级报名数与课次数。
- 进入班级详情和课次页。

### 4.5.2 班级详情 `/admin/classes/[id]`
- 编辑班级。
- 班级维度管理报名。

### 4.5.3 班级课次 `/admin/classes/[id]/sessions`
- 新建单次课次。
- 按周批量生成课次。
- 冲突处理策略：冲突拒绝 / 冲突跳过。
- 可为一对一课次指定学生。

### 4.5.4 报名管理 `/admin/enrollments`
- 新增报名、取消报名、恢复报名。
- 支持按班级分组查看与导出 PDF。
- 关键规则：
  - 学生必须有该课程有效课包才可报名。
  - 同一学生同一课程不允许重复创建（避免班课/一对一/加课时造成冲突）。

### 4.5.5 课包管理 `/admin/packages`
- 创建/编辑/删除课包。
- 支持班课包与一对一时间包并存。
- 关键规则：
  - 同一学生+同一课程+同一模式 的有效期不能重叠。
  - 不同模式可并存（班课包 + 一对一包）。

### 4.5.6 课包流水 `/admin/packages/[id]/ledger`
- 查看账本流水。
- 可做赠送（分钟或次数）。
- 支持导出 PDF（含中文）。

---

## 4.6 学生选课链接（预约）

### 4.6.1 链接列表 `/admin/booking-links`
- 创建选课链接（学生、日期范围、时长、步长、老师筛选）。
- 复制链接、查看请求数。
- 当前创建弹窗已双语化。

### 4.6.2 链接详情 `/admin/booking-links/[id]`
- 月历可选时段管理。
- 审批学生请求（通过/拒绝）。
- 导出该链接当月 PDF。

---

## 4.7 反馈与报表

### 4.7.1 老师反馈工作台 `/admin/feedbacks`
- 查看课后反馈。
- 标记转发。
- 代填草稿（催老师补全）。

### 4.7.2 月度课时明细 `/admin/reports/monthly-hours`
- 查询统计、导出 CSV。
- 口径：按点名保存时间 `Attendance.updatedAt`。

### 4.7.3 月课表总览 `/admin/reports/monthly-schedule`
- 月历视图。
- 导出 CSV / PDF。

---

## 4.8 管理者模块

### 4.8.1 管理者驾驶舱 `/admin/manager`
- 近期风险、事件流、本月日历。
- 面向管理者的运营视图。

### 4.8.2 系统使用者管理 `/admin/manager/users`
- 用户增删改、重置密码。
- 管理者名单维护（owner）。
- 关键权限：
  - 普通管理者不可编辑 `zhao hongwei`。
  - manager-admin 受保护不可编辑。

---

## 5. 老师端功能明细

### 5.1 总览 `/teacher`
- 今日课程、明日课程确认。
- 老师介绍快捷入口。

### 5.2 签到告警 `/teacher/alerts`
- 按课次处理未签到/反馈超时。
- 可快速标记学生状态。

### 5.3 我的可上课时间 `/teacher/availability`
- 按日期添加、批量添加、修改、删除。
- 支持清空整天与撤销。
- 时间范围限制：`08:00-23:00`。

### 5.4 我的课次 `/teacher/sessions`
- 按时间轴查看课次。
- 进入详情做点名与课后反馈。

### 5.5 课次详情 `/teacher/sessions/[id]`
- 点名保存。
- 课后反馈提交（建议课后 12 小时内）。

### 5.6 我的老师名片 `/teacher/card`
- 维护介绍。
- 下载名片 PDF。

---

## 6. 导出与 PDF 功能清单

- 报名导出 PDF：`/admin/enrollments/export/pdf`
- 学生课表 PDF：`/api/exports/student-schedule/[id]`
- 学生详情 PDF：`/api/exports/student-detail/[id]`
- 课包对账单 PDF：`/api/exports/package-ledger/[id]`
- 选课链接月历 PDF：`/api/booking-links/[id]/export/pdf`
- 老师名片 PDF（管理端、老师端）

说明：系统已统一处理中文字体，避免乱码；老师名片右侧排版已修复重叠。

---

## 7. 常见报错与处理

- `Student has no active package for this course`
  - 学生未购买该课程有效课包，先创建课包再报名/排课。

- `No eligible teachers` / 没有可匹配老师
  - 检查老师授课科目、老师可上课时间、时间冲突。

- `Outside availability`
  - 课次时间不在老师可上课区间内，先去维护可用时间。

- `Some selected teachers cannot teach this student courses`
  - 选课链接选中的老师与学生已购课程不匹配。

- 点名后扣费异常
  - 到课次点名页检查选择的课包、请假计费、流水记录。

---

## 8. 上线前/日常检查清单（给负责人）

每天建议检查：
1. 待办中心未点名数量是否归零。
2. 冲突巡检是否有未处理项。
3. 明日提醒是否确认。
4. 续费预警学生是否跟进。
5. 本周新增老师是否完成账号绑定。
6. 关键导出（学生课表/报名/课包）抽样可正常打开。

---

## 9. 建议的员工培训顺序

1. 登录与语言切换（5 分钟）
2. 待办中心 + 冲突处理（20 分钟）
3. 学生详情 + 快速排课（20 分钟）
4. 报名/课包规则（20 分钟）
5. 选课链接与审批（15 分钟）
6. 点名与反馈流程（15 分钟）
7. 导出与复核（10 分钟）

---

如需“岗位版手册”（前台顾问版、教务版、主管版、老师版）可在此基础上拆分成 4 份精简文档。
